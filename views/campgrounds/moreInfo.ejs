<% include ../partials/header%>
<div class='container mt-5'>
    <div class='row'>
        <div class ='col-md-3'>
            <h3 class='mb-3'> YelpCamp</h3>
            <div class='list-group'>
                <li class='list-group-item active'>Info 1</li>
                <li class='list-group-item'>Info 2</li>
                <li class='list-group-item'>Info 3</li>
            </div>
            <div id='map'></div>
        </div>
        <div class='col-md-9'>
            <div class='card'>
                <img src="<%= campground.image %>" class='card-img-top rounded' id='targetimg'>
                <div>
                    <h4 class='p-1 d-inline'><a href=''><%= campground.name %></a></h4>
                    <h4 class='text-right p-1 d-inline float-right'> $<%= campground.price %>/night</h4>
                </div>
                <p><em>Submitted by  <a href='/user/<%=campground.author.id %>'><%= campground.author.username%></a> </em></p>
                <p class='card-text p-1'><%= campground.description%></p>
                <% if (currentUser && campground.author.id.equals(currentUser._id) || currentUser && currentUser.admin){ %>
                <div class='ml-2 mb-2 '>
                    <a class='btn  btn-warning d-inline'href='/campgrounds/<%= campground._id %>/edit'> Edit </a>
                    <form class='d-inline'action='/campgrounds/<%= campground._id %>?_method=Delete' method='post'>
                        <button class='btn btn-xs btn-danger ml-2'> Delete </a>
                    </form>
                </div>
                <% } %>
               
            </div>
            <div class='border border-light bg-light mt-3 p-3' id='comment'>
                <div class='text-right mb-4'>
                    <a class='btn btn-sm btn-success' href='/campgrounds/<%=campground._id%>/comments/new'>Add new Comment</a>
                </div>
                <hr>
                <% campground.comments.forEach(function(comment){%>
                    <div class='row'>
                        <div class='col-md-12'>
                            <strong><%= comment.author.username%></strong>
                            <span class='float-right'>10 days ago</span>
                            <P class='mb-0'>
                               <%= comment.text%> 
                            </P>
                            <% if (currentUser && comment.author.id.equals(currentUser._id) || currentUser && currentUser.admin) { %>
                                <a class='btn btn-sm btn-warning d-inline'href='/campgrounds/<%=campground._id%>/comments/<%= comment._id %>/edit'> Edit </a>
                                <form class='d-inline'action='/campgrounds/<%=campground._id%>/comments/<%= comment._id %>?_method=Delete' method='post'>
                                    <input type='submit' value=' delete' class='btn btn-sm btn-danger ml-2'>
                                </form>
                            <% } %>

                        </div>
                        
                    </div>
                <% }) %>
            </div>
        </div>    
    </div>
</div>

<a href='/campgrounds'>Back</a>

<script>
    function showmap() {
        var geocoder = new google.maps.Geocoder();
        geocoder.geocode({'address': '<%=campground.location%>'}, function(result, status){
            if (status === 'OK') {
                var mapOptions = {
                    zoom: 8,
                    center: result[0].geometry.location
                    }
                var map = new google.maps.Map(document.getElementById('map'), mapOptions);
                var marker = new google.maps.Marker({position: result[0].geometry.location, map: map});
            } else {
            }
        })
     }
     
</script>
<script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDL3XSyCWyIdrFAu3iV5tKHaqkeaQwiGk4&callback=showmap">
</script>

    
<% include ../partials/footer%>

